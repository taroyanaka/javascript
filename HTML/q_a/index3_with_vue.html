<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>image-to-name</title>
<link rel="stylesheet" href="./lib/reset.css">
<script src="./lib/localforage@1.10.0.js"></script>
<!-- <script src="https://cdn.jsdelivr.net/npm/localforage@1.10.0/dist/localforage.min.js"></script> -->
<script src="./lib/vue@3.2.36.global.prod.js"></script>
<!-- <script src="https://cdn.jsdelivr.net/npm/vue@3.2.45/dist/vue.global.prod.js"></script> -->
<script src="./lib/ramda.@0.28.0.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/ramda/0.28.0/ramda.min.js"></script> -->

    <style>
/* imgã‚¿ã‚°ã‚’ç¸¦æ¨ª300px300pxã«è¨­å®šã™ã‚‹css */
img {
    width: 300px;
    height: 300px;
}
    </style>
</head>

<body>

<div class="image_to_name">



<textarea name="" id="from" cols="30" rows="10" v-model="image_to_name_string"></textarea>



  <div>
    <input type="file" @change="onFileSelected">
    <img :src="imageUrl" alt="selected image">
  </div>


    <!-- <img v-for="image in image_to_name_images" :src="image" /> -->




<template v-for="(DATAVAL, DATAIDX) in image_to_name_images_Q_AND_A">
<div>
    <img :src="image_to_name_images[DATAIDX]" :alt="image_to_name_images[DATAIDX]">
    <button v-for="ANSWER in setup_data[DATAIDX][1]" @click="image_to_name_fn_check_q_and_a_ramda(setup_data[DATAIDX][0], ANSWER, DATAIDX)">{{ ANSWER }}</button>
    <span >{{ return_YES_EMOJI_if_true_and_NO_EMOJI_if_false_ramda(DATAIDX) }}</span>
</div>
</template>
</div>

<script>
let
data0=
data1=
data2=
data3=
data4=
data5=
data6=
data7=
data8=
data9=
data10=
data11=
data12=
data13=
data14
= null;



// https://stackoverflow.com/a/68523152
// TODO: copy and paste mulberry32 and cyrb128 from
//       https://stackoverflow.com/a/47593316/6243352
function cyrb128(str) {
    let h1 = 1779033703, h2 = 3144134277,
        h3 = 1013904242, h4 = 2773480762;
    for (let i = 0, k; i < str.length; i++) {
        k = str.charCodeAt(i);
        h1 = h2 ^ Math.imul(h1 ^ k, 597399067);
        h2 = h3 ^ Math.imul(h2 ^ k, 2869860233);
        h3 = h4 ^ Math.imul(h3 ^ k, 951274213);
        h4 = h1 ^ Math.imul(h4 ^ k, 2716044179);
    }
    h1 = Math.imul(h3 ^ (h1 >>> 18), 597399067);
    h2 = Math.imul(h4 ^ (h2 >>> 22), 2869860233);
    h3 = Math.imul(h1 ^ (h3 >>> 17), 951274213);
    h4 = Math.imul(h2 ^ (h4 >>> 19), 2716044179);
    return [(h1^h2^h3^h4)>>>0, (h2^h1)>>>0, (h3^h1)>>>0, (h4^h1)>>>0];
}
function mulberry32(a) {
    return function() {
      var t = a += 0x6D2B79F5;
      t = Math.imul(t ^ t >>> 15, t | 1);
      t ^= t + Math.imul(t ^ t >>> 7, t | 61);
      return ((t ^ t >>> 14) >>> 0) / 4294967296;
    }
}
const seededRandom = ({rng = null, seed = "apples"} = {}) => {
  rng = rng || mulberry32(cyrb128(seed)[0]);

  const rnd = (lo, hi, defaultHi=1) => {
    if (hi === undefined) {
      hi = lo === undefined ? defaultHi : lo;
      lo = 0;
    }

    return rng() * (hi - lo) + lo;
  };

  const rndInt = (lo, hi) => Math.floor(rnd(lo, hi, 2));

  const shuffle = a => {
    for (let i = a.length - 1; i > 0; i--) {
      const j = rndInt(i + 1);
      const x = a[i];
      a[i] = a[j];
      a[j] = x;
    }
    return a;
  };

  return {rnd, rndInt, shuffle};
};
const {
  rnd, rndInt, shuffle
} = seededRandom({seed: "optional seed string"});




const image_to_name = Vue.createApp({
data() {
    return {
image_to_name_data_0: 'ANY',
image_to_name_data_1: [],
image_to_name_image_data: null,
imageUrl: null,
image_to_name_images: ["cat.png", "dog.png", "halr.png"],
image_to_name_string: `cat
dog
halr`,
image_to_name_array: null,
image_to_name_images_Q_AND_A: null,
image_to_name_images_without_image_format_str: [],
setup_data: [],
    }},
watch: {
   any: {
     handler() {
     },
     deep: true
   },
},
beforeMounte(){
},
mounted() {
    this.r_zip_form_image_to_name_array_and_image_to_name_images();
    this.setup();
    this.to_ary_all_dataNum();
},
beforeUpdate() {
},
updated() {
},
methods: {
image_to_name_fn_0(){
    console.log(this.image_to_name_data_0);
},
image_to_name_fn_1(){
    console.log(JSON.parse(JSON.stringify(this.image_to_name_data_1)));
},
image_to_name_fn_2(ANSWER, COLLECT_ANSWER){
    console.log(JSON.parse(JSON.stringify(a,b,c)));
},
// ç¬¬ä¸€å¼•æ•°ã‚’ç¬¬äºŒå¼•æ•°ãŒåˆè‡´ã—ã¦ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¦ã€åˆè‡´ã—ã¦ã„ã‚Œã°ç¬¬ä¸‰å¼•æ•°ã®INDEXã«trueã‚’å…¥ã‚Œã¦ã€åˆè‡´ã—ã¦ã„ãªã‘ã‚Œã°ç¬¬ä¸‰å¼•æ•°ã®INDEXã«falseã‚’å…¥ã‚Œã‚‹ramda.jsã‚’åˆ©ç”¨ã—ã¦1è¡Œã§æ›¸ã„ãŸé–¢æ•°
image_to_name_fn_check_q_and_a_ramda(ANSWER, COLLECT_ANSWER, IDX){
    this.image_to_name_data_1[IDX] = R.ifElse(R.equals(ANSWER), R.always(true), R.always(false))(COLLECT_ANSWER);
},
// trueãªã‚‰YES_EMOJIã‚’è¿”ã—falseãªã‚‰NO_EMOJIã‚’è¿”ã™ramda.jsã‚’åˆ©ç”¨ã—ã¦1è¡Œã§æ›¸ã„ãŸé–¢æ•°
return_YES_EMOJI_if_true_and_NO_EMOJI_if_false_ramda(IDX){
    return R.ifElse(R.equals(true), R.always("ğŸ‘"), R.always("ğŸš«"))(this.image_to_name_data_1[IDX]);
},


imageUpload(INT_NUM){
    if(document.querySelector("input[type=file]").files[0] === undefined){
        document.querySelector(".answer").placeholder = "select image";
        return;
    }
    Array.from(document.querySelector("input[type=file]").files).forEach((FILE, IDX)=> document.querySelector(".qa_" + (INT_NUM + IDX).toString()).querySelector("img").src = URL.createObjectURL(FILE) );
},
// https://stackoverflow.com/a/71869551
async image_save_by_base64(){
    const getBase64FromUrl = async (url) => {
        const data = await fetch(url);
        const blob = await data.blob();
        return new Promise((resolve) => {
        const reader = new FileReader();
        reader.readAsDataURL(blob);
        reader.onloadend = () => {
            const base64data = reader.result;
            resolve(base64data)
        };
        });
    };

    const myImage = await getBase64FromUrl(document.querySelector("img").src);
    return myImage;
},
// tmp_data = await image_save_by_base64();
async image_save_by_base64_2(){
    document.querySelectorAll("img")[1].src = tmp_data;
},



create_an_array_of_nulls_of_length_of_length_this_image_to_name_images(){
    this.image_to_name_data_1 = Array(this.image_to_name_images.length).fill(null);
},
setup(){
    const from_ary = this.image_to_name_array;
    this.setup_data = from_ary.map((V, IDX)=>{
        return [V, shuffle(shuffle(R.without(from_ary[IDX], from_ary)).slice(0, 2).concat(from_ary[IDX]))];
    });
    this.create_an_array_of_nulls_of_length_of_length_this_image_to_name_images();
},

onFileSelected(event) {
    // console.log(event.target.files[0]);
    const file = event.target.files[0]
    const reader = new FileReader()
    reader.onload = (e) => {
        this.imageUrl = e.target.result
        data0 = this.imageUrl;
    }
    reader.readAsDataURL(file)
},


image_to_name_array_from_image_to_name_string(){
    this.image_to_name_array = this.image_to_name_string.split("\n");
},
r_zip_form_image_to_name_array_and_image_to_name_images(){
    this.image_to_name_array_from_image_to_name_string();
    this.function_to_remove_a_string_from_an_array_string_that_is_contained_in_any_array();
    this.image_to_name_images_Q_AND_A = R.zip(
        this.image_to_name_array,
        this.image_to_name_images_without_image_format_str
    );
    this.to_ary_all_dataNum();
},
to_ary(it){
    return JSON.parse(JSON.stringify(it));
},
to_ary_all_dataNum(){
    data0 = this.image_to_name_images;
    data1 = this.image_to_name_array;
    data2 = this.image_to_name_images_without_image_format_str;
    data3 = this.image_to_name_images_Q_AND_A
    data4 = this.setup_data;
    data5 = this.image_to_name_data_1;
    data0 = this.to_ary(data0);
    data1 = this.to_ary(data1);
    data2 = this.to_ary(data2);
    data3 = this.to_ary(data3);
    data4 = this.to_ary(data4);
    data5 = this.to_ary(data5);
// ãã‚Œãã‚Œã®å¤‰æ•°ã‚’console.logã™ã‚‹
    console.log(data0,data1,data2,data3,data4,data5);
},
function_to_remove_a_string_from_an_array_string_that_is_contained_in_any_array(){
    format = ['.bmp', '.gif', '.ico', '.jpeg', '.jpg', '.png', '.svg', '.tif', '.tiff', '.webp'];
    this.image_to_name_images_without_image_format_str = [];
    this.image_to_name_images.map(V => {
        return format.map(V2 => {
            if(V.includes(V2)){
                this.image_to_name_images_without_image_format_str.push(V.replace(V2, ''));
            }
        })
    });
}









},
}).mount('.image_to_name');

// ç©ºç™½æ–‡å­—åˆ—ã‚’_ã§åŸ‹ã‚ã‚‹é–¢æ•°
function fill_blank_with_underscore(str){
    return str.replace(/\s+/g, '_');
}
</script>
</body>
</html>

